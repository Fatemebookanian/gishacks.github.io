---
title: جلسه ۵ - گزارش آماری از جداول لایه‌های مکانی
---

در این جلسه یاد می‌گیریم چطور با استفاده از جدول داده‌ها در GIS اطلاعات آماری مثل مساحت، تعداد و درصد هر کاربری را محاسبه کنیم و در نهایت خروجی گزارشی (Report) بسازیم.

---

## ۱. باز کردن جدول

ابتدا فایل پروژه را باز می‌کنیم و لایه مورد نظر را (برای مثال لایه پولیگنی) از قسمت **Contents** انتخاب می‌کنیم.  
سپس از پایین صفحه گزینه **Attribute Table** را باز می‌کنیم تا جدول لایه دیده شود.  
در پایین جدول، سمت چپ، می‌توان تعداد کل رکوردها را مشاهده کرد.  

---

## ۲. انتخاب رکوردها و نمایش روی نقشه

در جدول روی یکی از ردیف‌ها کلیک می‌کنیم تا در نقشه هایلایت شود.  
با راست کلیک روی همان رکورد در جدول می‌توان گزینه‌های زیر را دید:  
- **Zoom to:** زوم می‌کند روی همان عارضه.  
- **Pan to:** باعث چشمک زدن و نمایش موقعیت دقیق آن عارضه در نقشه می‌شود.  

---

## ۳. مشاهده آمار هر فیلد (Visualize Statistics)

برای دیدن آمار مثل میانگین، حداقل و حداکثر، روی نام فیلد مثلاً **Shape_Area** راست کلیک می‌کنیم و گزینه **Visualize Statistics** را انتخاب می‌کنیم.  
در این قسمت میانگین، کمترین، بیشترین و مجموع مساحت‌ها مشخص است.

---

## ۴. خلاصه‌سازی جدول (Summarize)

روی فیلدی مثل **Label** راست کلیک کرده و گزینه **Summarize** را انتخاب می‌کنیم.  
در پنجره‌ای که باز می‌شود:
- **Field:** همان Label (بر اساس کاربری)
- **Statistics field:** مثلاً ObjectID، و در روبروی آن **Count** را انتخاب می‌کنیم تا تعداد هر نوع کاربری را بشمارد.  
با زدن **OK** جدول جدیدی ساخته می‌شود که نتیجه خلاصه‌سازی را نشان می‌دهد.

![summarize table](https://github.com/user-attachments/assets/aaae4b6c-1ee0-4520-9350-7b69ffaea6bc)

---

## ۵. محاسبه مجموع مساحت کاربری‌ها

برای بدست آوردن مجموع مساحت هر کاربری:
روی فیلد **Shape_Area** راست کلیک کنید و دوباره Summarize را بزنید.  
در پنجره باز شده:
- بالای صفحه **Shape_Area**
- پایین صفحه **Label**  
را انتخاب کنید و OK بزنید.

![ summarize Shape_Area](https://github.com/user-attachments/assets/8126ce96-acca-40b7-af3c-31902b8d259d)

---

## ۶. تغییر نام فیلدها (Alias)

برای خواناتر کردن عناوین جدول:  
از تب بالایی جدول، وارد **Fields** شوید.  
در ستون **Alias** می‌توانید نام فیلدها را تغییر دهید، مثلاً:
- Label → کاربری  
- Frequency → تعداد  

همچنین برای فیلدهای عددی (Numeric Field):
- روی قسمت تنظیمات کنار عدد دوبار کلیک کنید،  
- تعداد اعشار را روی ۲ قرار دهید،  
- گزینه **Show Thousand Separators** را فعال کنید تا اعداد سه رقمی جدا شوند.

![edit alias fields](https://github.com/user-attachments/assets/37e8c5ed-f866-4ef4-848e-c524bc19fe84)  
![numeric settings](https://github.com/user-attachments/assets/6a785ad6-ff58-4d53-b8c3-e941b6212583)

---

## ۷. افزودن جدول به Layout

از تب **Insert → New Layout** استفاده می‌کنیم.  
یک اندازه صفحه‌ مثل A4 انتخاب کنید، سپس از **Map Frame** نقشه را روی صفحه بکشید.  
بعد از قرار دادن نقشه، حالا از **Insert → Table Frame** استفاده می‌کنیم تا جدول خلاصه‌سازی را به صفحه اضافه کنیم.  

جلویی‌ترین جدول را انتخاب کرده، روی آن راست‌کلیک کنید → **Properties → Source** و جدول ساخته شده را از لیست انتخاب کنید.

![add table layout](https://github.com/user-attachments/assets/c5d1d2fd-6f90-46fe-99c9-25a119d4e6c2)  
![set table source](https://github.com/user-attachments/assets/cfc72d6b-658d-4161-ac21-893356797a73)

---

## ۸. اضافه کردن فیلد جدید برای درصد

در جدول خلاصه، دکمه **Add Field** را می‌زنیم تا فیلد جدیدی برای درصد بسازیم:  
- Name: Percent  
- Alias: درصد  
- Data Type: Float  

![new field](https://github.com/user-attachments/assets/6e14db3b-db08-4efe-a13a-aa5d6e401ab0)

---

## ۹. محاسبه درصد مساحت‌ها

برای محاسبه درصد سهم هر کاربری:
1. روی Shape_Area راست‌کلیک → **Visualize Statistics**  
2. مقدار مجموع (Sum) را کپی کنید.  
3. حالا روی ستون Percent راست‌کلیک → **Calculate Field**  
4. در فرمول بنویسید:  
Percent = Shape_Area / کل‌مساحت

سپس Apply.

![calculate percent](https://github.com/user-attachments/assets/fccb8fbb-b89b-46ae-8bdd-5625a99181d2)

---

## ۱۰. ساخت گزارش (Report)

برای تهیه گزارش از جدول نهایی:
1. از تب **Insert → New Report** استفاده کنید.  
2. لایه‌ی خلاصه شده را انتخاب کنید.  
3. نوع گزارش را بر اساس نیاز تعیین کنید (Attribute List، Summary، Grouping و ...)  
4. فیلدهای مورد نظر را انتخاب کرده و OK بزنید.  
5. در تب Report روی **Preview** کلیک کنید و گزارش نهایی را ببینید.

---

## تمرین پایانی
یک لایه کاربری انتخاب کنید و:
1. جدول آن را خلاصه‌سازی کنید.  
2. مساحت هر کاربری را محاسبه کنید.  
3. درصدها را اضافه و در Layout جدول بسازید.  
4. در پایان، با گزینه **New Report** گزارش نهایی را ساخته و PDF خروجی بگیرید.

---
