---
title: جلسه ۵ - گزارش آماری از جداول لایه‌های مکانی
-# جلسه 27 و 29 مهر: گزارش آماری جداول

## 1-   باز کردن جدول

بعد از باز کردن یک پروژه (در اینجا لایه پولیگنی) و در دسترس داشتن پنل‌های Contents و  Attribute Table، فیلدهای جدول مشاهده می‌شود که در آن، فیلدهای OBJECTID (شناسه)، SHAPE (نشان دهنده شکل عارضه، در اینجا پولیگن)، SHAPE-AREA و SHAPE-LENGTH ثابت و غیر قابل تغییر هستند. اولین اطلاعاتی که در این مرحله در اختیار ما قرار می‌گیرد، تعداد کل عارضه‌ها یا Records است که در پایین جدول، سمت چپ نمایش داده می‌شود.

## 2-   انتخاب یک رکورد و نمایش آن روی نقشه
ردیف (record) مورد نظر را در جدول انتخاب کرده و می‌بینیم که روی نقشه هم هایلایت می‌شود.

**روی شماره ردیف مورد نظر راست کلیک می‌کنیم:**

### ·       انتخاب zoom to: نقشه روی خود عارضه زوم می‌شود

### ·       انتخاب pan to: باعث می‌شود عارضه چشمک بزند یا برای پیدا کردنش در نقشه به کار می‌رود

## 3-   مشاهده آمار (Visualize Statistics) برای فیلد مورد نظر

در جدول، روی هدر فیلد مورد نظر، مثل مساحت، راست کلیک می‌کنیم و Visualize Statistics را انتخاب می‌کنیم.
پنجره آمار باز می‌شود و مقادیری مانند میانگین (mean)، مینیمم (min)، ماکسیمم (max)، مجموع (sum) و ... قابل مشاهده است. (به عنوان مثال، برای محاسبه درصد مساحت هر کاربری، به مساحت کل نیاز داریم.)

## 4-   خلاصه‌سازی جدول بر اساس یک فیلد (Summarize)
روی فیلد مورد نظر که می‌خواهیم جدول ما بر آن اساس خلاصه شود، راست کلیک کرده و Summarize را انتخاب می‌کنیم تا گزارش ما خواناتر شود.

**پنجره** **Summarize****:**

### ·       قسمت بالا، نشان دهنده اسم لایه‌ای است که می‌خواهیم خلاصه‌سازی را روی آن انجام دهیم. 

### ·       قسمت پایین، تعیین می‌کند که بر اساس چه فیلدی می‌خواهیم خلاصه کنیم. (در این مثال: Label)

### ·       قسمت وسط معمولا عملگرهایی است که می‌خواهیم روی فیلدهای دیگر اجرا شود؛ به عنوان مثال، برای شمارش رکوردها: OBJECTID (Count) را انتخاب می‌کنیم تا تعداد هر گروه شمرده شود.

### ·       بعد از زدن OK، جدول اصلی تغییر نمی‌کند، اما یک جدول جدید خلاصه شده در پنل Contents اضافه می‌شود.

### ·       روی لایه جدول خلاصه شده راست کلیک کرده و گزینه open را انتخاب می‌کنیم. 

## 5-   تغییر نام (Alias) فیلدها برای خوانایی بهتر گزارش

### ·       روی  Shape Area راست کلیک کرده و Summarize را انتخاب می‌کنیم.

**در پنجره سامرایز:**
قسمت بالا را Shape Area و قسمت پایین را همچنان Label قرار می‌دهیم؛ چون به مساحت‌های کاربری‌ها نیاز داریم.

### ·       هنگامی که جدول باز است، از تب بالا Table را انتخاب کرده و Fields را انتخاب می‌کنیم.
فیلد Name قابل تغییر نیست و نباید تغییر داده شود اما فیلد Alias قابل تغییر است. ( در این مثال: تغییر label به کاربری و frequency به
تعداد)

### ·       برای فیلدهای عددی مانند مساحت: روی سه نقطه Numberic کلیک کرده و تعداد اعشار را برای خوانایی، در بخش Rounding کم می‌کنیم (مثلا 2) و گزینه Show thousands separators را فعال می‌کنیم. (جداسازی رقم‌ها برای خوانایی)

## 6-   اضافه کردن فیلد جدید (برای محاسبه درصد)
برای اضافه کردن فیلد به جدول خلاصه شده، در قسمت گوشه بالا، سمت چپ جدول، باید از Add Field استفاده کنیم و حتما اسم فیلد جدید را باید انگلیسی وارد کنیم. 

**مشخصات فیلد:**
Name: همیشه انگلیسی (Percent) و بدون فاصله

Alias: نام خوانا (درصد)

Data Type: Float، برای عدد اعشاری با دقت معمولی (Double دقت بیشتری برای اعداد اعشاری دارد)

**نکته:** string/text برای متن و integer برای اعداد صحیح می‌باشد.
**نکته:** دیتا تایپ فیلدی که ساخته می‌شود دیگر قابل تغییر نیست.

**محاسبه درصد:**

### ·       کلیک راست روی فیلد درصد و انتخاب Calculate Field

### ·       بعد از باز شدن پنجره Calculate، در قسمت Percent= دو بار روی Shape Area کلیک می‌کنیم.

### ·       سپس از علامت تقسیم (/) استفاده کرده و مساحت کل منطقه مورد را که از قسمت Visualize Statistics برداشته بودیم، کپی می‌کنیم (اگر بر اساس هزار جدا شده بود، کاماها را پاک می‌کنیم) و سپس Apply می‌کنیم.

**نکته:** توجه داشته باشیم که باید همه ردیف‌ها را select کنیم.

# اضافه کردن جدول به نقشه (Layout)

### ·       ورود به تب Insert

### ·       انتخاب Layout

### ·       ورود به Table Frame

### ·       بعد از کشیدن موس در محل مورد نظر برای نمایش جدول، باید منبع داده جدول یا Source را تعیین کنیم.

### ·       برای این منظور، روی جدول در قسمت Contents راست کلیک می‌کنیم و وارد Properties می‌شویم.

### ·       از قسمت Source  جدول مورد نظر را انتخاب می‌کنیم.

**برای ویرایش ظاهر جدول:**

### ·       جدول را Select می‌کنیم.

### ·       به تب Table Frame در نوار بالا می‌رویم.

### ·       از قسمت Table Frame Gallery برای تغییر استایل و قالب نمایش جدول استفاده می‌کنیم.

# استفاده از قابلیت‌های Report و Presentation
هر دو در تب Insert.
**New Report****:**

پنجره‌ای در سمت راست صفحه باز می‌شود که باید در آن لایه مورد نظر را که جدول خلاصه شده است، انتخاب ‌کنیم و همچنین باید نوع گزارش و فیلدهایی که می‌خواهیم در گزارش ما باشند را مشخص کنیم.

**انواع گزارش در این قسمت:**

**Attribute list****:** برای گزارش توصیفی

**Attribute List By Grouping****:** لیست صفات اما دسته‌بندی شده بر اساس یک فیلد

**Basic Summary****:** خلاصه ساده جدول مانند میانگین، جمع، تعداد و ...

**Statistics****:** آمار کلی مجموعه

**Grouping Per Features****:** شناسنامه هر عارضه، برای هر عارضه یک صفحه مجزا

در آخر این مرحله یک طرح کلی از Layout  بدون اطلاعات به ما نمایش داده می‌شود.
برای مشاهده گزارش، از تب‌های بالا، بر روی تب Report کلیک کرده و قسمت Preview را انتخاب می‌کنیم.

**New Presentation****:**

### ·       برای اضافه کردن مپ‌های دلخواه، از insert page استفاده می‌کنیم.

### ·       با کلیک راست روی هر اسلاید و انتخاب Transition، می‌توانیم ارائه زیباتری داشته باشیم. (fly)

# خروجی از جدول برای بردن به اکسل و ایجاد تغییرات حرفه‌ای‌تر

### ·       جدول مورد نظر را باز می‌کنیم.

### ·       وارد تب Table شده و Export Table را انتخاب می‌کنیم و در قسمت name، اسمی با فرمت .CSV ثبت می‌کنیم.

**نکته:** این جدول را نباید در Geodatabases اکسپورت کنیم.

**بخش** **Excel****:**

### ·       برای خلاصه‌سازی یا Summarize کردن جدول در اکسل، باید از Pivot استفاده کنیم.

### ·       در پنجره سمت راست که باز می‌شود: فیلدهای مورد نظر را در قسمت‌های دلخواه Drag می‌کنیم. (به عنوان مثال، کاربری‌ها در قسمت Rows قرار بگیرند)

**نکته:** در ArcGIS Pro فقط از سطرها می‌توانیم گزارش بگیریم؛ اما در اکسل هم از سطرها و ستون‌ها.
**نکته:** راه دیگر باز کردن فایل با فرمت csv، این است که وارد تب Data شویم و From text/CSV را انتخاب کنیم.
**نکته:** اگر بخواهیم از جدول داخل نقشه استفاده کنیم، بهتر است برای تنظیمات و تغییرات جدول از همان GIS Pro استفاده کنیم.

**روش دیگر برای انتقال داده‌ها به اکسل:**

### ·       تب View

### ·       Toolbox

### ·       مجموعه ابزار برای تبدیل: Conversion tools

### ·       انتخاب اکسل--
